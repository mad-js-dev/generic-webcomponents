!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GenericWebComponents={},e.React)}(this,function(e,t){"use strict";class n extends HTMLElement{static get observedAttributes(){return["reverse-heading","single-item","accordion"]}constructor(){super(),this.attachShadow({mode:"open"}),this._isUpdating=!1,this._handleItemToggle=this._handleItemToggle.bind(this);const e=document.createElement("div"),t=document.createElement("slot"),n=document.createElement("style");n.textContent="\n      :host {\n        display: block;\n        width: 100%;\n        --indent-size: 1.5rem;\n      }\n      \n      ::slotted(collapsible-item) {\n        display: block;\n        margin: 0.25rem 0;\n        padding: 0;\n        width: 100%;\n      }\n      \n      /* Nested lists should have a border */\n      ::slotted(collapsible-list) {\n        border-left: 1px solid #e0e0e0;\n        margin-left: 0.5rem;\n        padding-left: 0.5rem;\n      }\n      \n      /* Style for the header in collapsible items */\n      .collapsible-item__header {\n        display: flex;\n        align-items: center;\n        width: 100%;\n        flex-direction: row;\n      }\n      \n      /* Toggle container styles */\n      .collapsible-item__toggle-container {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: var(--toggle-size, 24px);\n        height: var(--toggle-size, 24px);\n        margin: var(--toggle-margin, 0 8px 0 0);\n        flex-shrink: 0;\n      }",e.appendChild(t),this.shadowRoot.append(n,e)}async connectedCallback(){this._initialized||(this._initializeComponent(),this._initialized=!0,await this._updateReverseHeading(),this.addEventListener("toggle",this._handleItemToggle),this.hasAttribute("accordion")&&this._ensureOneItemExpanded()),this._setupMutationObserver()}_initializeComponent(){this.hasAttribute("role")||this.setAttribute("role","list"),!this.hasAttribute("aria-label")&&this.hasAttribute("aria-labelledby")}_setupMutationObserver(){this._observer=new MutationObserver(async e=>{let t=!1;for(const n of e){if("attributes"===n.type&&"reverse-heading"===n.attributeName){t=!0;break}if("childList"===n.type){for(const e of n.addedNodes)if(e.nodeType===Node.ELEMENT_NODE&&(e.matches("collapsible-item")||e.matches("collapsible-list"))){t=!0;break}if(t)break}}t&&await this._updateReverseHeading()}),this._observer.observe(this,{attributes:!0,attributeFilter:["reverse-heading"],childList:!0,subtree:!0})}async _updateReverseHeading(){if(!this._isUpdating){this._isUpdating=!0;try{const e=this.hasAttribute("reverse-heading")&&"false"!==this.getAttribute("reverse-heading");this._observer&&this._observer.disconnect();const t=async i=>{for(const s of i){e?s.setAttribute("reverse-heading",""):s.removeAttribute("reverse-heading");const i=s.querySelectorAll(":scope > collapsible-item");i.length>0&&await t(Array.from(i));const o=s.querySelectorAll(":scope > collapsible-list");o.length>0&&await n(Array.from(o))}},n=async i=>{for(const s of i){if(s===this)continue;e?s.setAttribute("reverse-heading",""):s.removeAttribute("reverse-heading");const i=s.querySelectorAll(":scope > collapsible-item");i.length>0&&await t(Array.from(i));const o=s.querySelectorAll(":scope > collapsible-list");o.length>0&&await n(Array.from(o))}},i=this.querySelectorAll(":scope > collapsible-item");i.length>0&&await t(Array.from(i));const s=this.querySelectorAll(":scope > collapsible-list");s.length>0&&await n(Array.from(s)),this.shadowRoot&&this.shadowRoot.offsetHeight}catch(e){}finally{this._observer&&this._observer.observe(this,{attributes:!0,attributeFilter:["reverse-heading"],childList:!0,subtree:!0}),this._isUpdating=!1}}}_handleItemToggle(e){if(this._isUpdating)return;const t=e.target;t.parentElement===this&&(this._isUpdating=!0,this.hasAttribute("accordion")?t.expanded&&this._closeOtherItems(t):this.hasAttribute("single-item")&&t.expanded&&this._closeOtherItems(t),this._isUpdating=!1)}_closeOtherItems(e){if(this.closest("image-collection"))return;this.querySelectorAll("collapsible-item").forEach(t=>{t!==e&&(t.expanded=!1)})}_getOpenItems(){return Array.from(this.querySelectorAll("collapsible-item[expanded]"))}_ensureOneItemExpanded(){if(!this.hasAttribute("accordion"))return;if(0===this._getOpenItems().length){const e=this.querySelector("collapsible-item");e&&e.setAttribute("expanded","")}}}customElements.get("collapsible-list")||customElements.define("collapsible-list",n);const i=Object.freeze(Object.defineProperty({__proto__:null,CollapsibleList:n},Symbol.toStringTag,{value:"Module"}));class s extends HTMLElement{static get observedAttributes(){return["expanded","reverse-heading","hide-icon"]}constructor(){super(),this.attachShadow({mode:"open"}),this._isExpanded=!1,this._nestedList=null,this._showToggle=!1,this._initialized=!1,this._handleHeaderClick=this._handleHeaderClick.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this)}connectedCallback(){if(!this._initialized){this._initializeComponent(),this._initialized=!0;const e=this.hasAttribute("expanded");this._isExpanded=e,this._nestedContent&&(this._nestedContent.style.display=e?"block":"none")}this._updateToggleVisibility(),this._updateReverseHeading(),this._updateAriaExpanded(),this._toggleElement&&(this.expanded?this._toggleElement.classList.add("collapsible-item__toggle--expanded"):this._toggleElement.classList.remove("collapsible-item__toggle--expanded"))}_initializeComponent(){this.shadowRoot?this.shadowRoot.innerHTML="":this.attachShadow({mode:"open"});const e=document.createElement("div");e.className="collapsible-item",this._headerElement=document.createElement("div"),this._headerElement.className="collapsible-item__header",this._headerElement.setAttribute("part","header");let t=null;this.hasAttribute("hide-icon")||(t=document.createElement("div"),t.className="collapsible-item__toggle-container",this._toggleElement=document.createElement("button"),this._toggleElement.className="collapsible-item__toggle",this._toggleElement.setAttribute("aria-label","Toggle visibility"),this._toggleElement.setAttribute("aria-expanded","false"),this._toggleElement.innerHTML="â–¼",t.appendChild(this._toggleElement)),this._headerSlot=document.createElement("slot"),this._headerSlot.name="header";const n=document.createElement("div");n.className="collapsible-item__content",n.appendChild(this._headerSlot),t&&this._headerElement.appendChild(t),this._headerElement.appendChild(n),this._defaultSlot=document.createElement("slot"),this._nestedContent=document.createElement("div"),this._nestedContent.className="collapsible-item__nested",this._nestedContent.style.display="none",this._nestedContent.appendChild(this._defaultSlot),this._headerElement.addEventListener("click",this._handleHeaderClick),this._headerElement.addEventListener("keydown",this._handleKeyDown),this._toggleElement&&this._toggleElement.addEventListener("click",e=>{e.stopPropagation(),this.toggle()}),e.appendChild(this._headerElement),e.appendChild(this._nestedContent);const i=document.createElement("style");i.textContent="\n      :host {\n        display: block;\n        margin: 0;\n        padding: 0;\n      }\n\n      .collapsible-item {\n          display: flex;\n          flex-direction: column;\n          width: 100%;\n      }\n      \n      .collapsible-item__header {\n        display: flex;\n        align-items: center;\n        width: 100%;\n        margin: 0;\n        padding: 0;\n        background: none;\n        border: none;\n        font: inherit;\n        color: inherit;\n        cursor: pointer;\n      }\n      \n      .collapsible-item__toggle-container {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 24px;\n        height: 24px;\n        flex-shrink: 0;\n        margin-right: 8px;\n        \n      }\n      \n      .collapsible-item__toggle {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        background: none;\n        border: none;\n        cursor: pointer;\n        transition: transform 0.2s ease-in-out;\n        font-size: 0.8em;\n        line-height: 1;\n        color: inherit;\n      }\n      \n      .collapsible-item__toggle--hidden {\n        visibility: hidden;\n        width: 0;\n        margin: 0;\n      }\n      \n      .collapsible-item__toggle--expanded {\n        transform: rotate(180deg);\n      }\n      \n      .collapsible-item__content {\n        flex: 1 1 auto;\n        min-width: 0; /* Allows content to shrink below its minimum content size */\n        text-align: left;\n        margin: 0;\n        padding: 0;\n        overflow: hidden; /* Ensures content doesn't overflow */\n        display: flex;\n        align-items: center;\n      }\n      \n      .collapsible-item__content ::slotted(*) {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis; /* Add ellipsis for overflow text */\n        text-overflow: ellipsis;\n      }\n      \n      .collapsible-item__nested {\n        margin: 0;\n        padding: 0;\n        display: block;\n        overflow: hidden;\n      }\n      collapsible-item > collapsible-list {\n        padding-left: 1rem;\n      }\n    ",this.shadowRoot.append(i,e)}_handleHeaderClick(e){e.target.closest(["a","button","input","select","textarea"].join(","))||(e.preventDefault(),e.stopPropagation(),this.toggle())}_handleKeyDown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.toggle())}_updateToggleVisibility(){if(!this._headerElement)return;const e=this.shadowRoot.querySelector(".collapsible-item__content"),t=this.hasAttribute("no-children");if(this.hasAttribute("hide-icon")||t)return this._showToggle=!1,this._toggleElement&&(this._toggleElement.style.display="none"),e&&(e.style.marginLeft="0",e.style.paddingLeft="0"),this._headerElement.style.paddingLeft="0",void(this._headerElement.style.marginLeft="0");const n=this._nestedContent&&this._nestedContent.children.length>0;this._showToggle=n,this._toggleElement&&(this._toggleElement.style.display=this._showToggle?"inline-block":"none",this.expanded?this._toggleElement.classList.add("collapsible-item__toggle--expanded"):this._toggleElement.classList.remove("collapsible-item__toggle--expanded")),this._showToggle&&this._headerElement?(this._headerElement.setAttribute("role","button"),this._headerElement.setAttribute("tabindex","0"),this._headerElement.setAttribute("aria-expanded",this.expanded.toString()),this._headerElement.classList.add("collapsible-item__header--clickable"),this.expanded?this._toggleElement.classList.add("collapsible-item__toggle--expanded"):this._toggleElement.classList.remove("collapsible-item__toggle--expanded")):(this._toggleElement.style.display="none",this._toggleElement.classList.add("collapsible-item__toggle--hidden"),this._headerElement.removeAttribute("role"),this._headerElement.removeAttribute("tabindex"),this._headerElement.removeAttribute("aria-expanded"),this._headerElement.classList.remove("collapsible-item__header--clickable"))}get expanded(){return this._isExpanded}set expanded(e){const t=Boolean(e);if(this._isExpanded!==t){if(this._isExpanded=t,this._nestedContent)if(t){this._nestedContent.style.display="block",this._nestedContent.style.overflow="hidden",this._nestedContent.style.height="auto";const e=this._nestedContent.offsetHeight;this._nestedContent.style.height="0",requestAnimationFrame(()=>{this._nestedContent.style.transition="height 0.3s ease-in-out",this._nestedContent.style.height=`${e}px`,setTimeout(()=>{this._nestedContent.style.transition="",this._nestedContent.style.height="",this._nestedContent.style.overflow=""},300)})}else{const e=this._nestedContent.offsetHeight;this._nestedContent.style.height=`${e}px`,this._nestedContent.style.overflow="hidden",requestAnimationFrame(()=>{this._nestedContent.style.transition="height 0.3s ease-in-out",this._nestedContent.style.height="0",setTimeout(()=>{this._nestedContent&&(this._nestedContent.style.display="none",this._nestedContent.style.transition="",this._nestedContent.style.height="")},300)})}this._headerElement&&(t?this._headerElement.classList.add("collapsible-item__header--expanded"):this._headerElement.classList.remove("collapsible-item__header--expanded"),this._showToggle&&this._headerElement.setAttribute("aria-expanded",t.toString())),this._toggleElement&&(t?this._toggleElement.classList.add("collapsible-item__toggle--expanded"):this._toggleElement.classList.remove("collapsible-item__toggle--expanded")),this._dispatchEvents(t)}}toggle(e){const t=void 0!==e?e:!this.expanded;this.expanded=t,this._updateAriaExpanded(),this._toggleElement&&(t?this._toggleElement.classList.add("collapsible-item__toggle--expanded"):this._toggleElement.classList.remove("collapsible-item__toggle--expanded")),this._dispatchEvents(t)}_dispatchEvents(e){this.dispatchEvent(new CustomEvent("toggle",{detail:{expanded:e},bubbles:!0,composed:!0}));const t=e?"expanded":"collapsed";this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0}))}_updateAriaExpanded(){this._headerElement&&this._headerElement.setAttribute("aria-expanded",this._isExpanded.toString())}_updateReverseHeading(){var e,t;const n=this.hasAttribute("reverse-heading")&&"false"!==this.getAttribute("reverse-heading"),i=null==(e=this.shadowRoot)?void 0:e.querySelector(".collapsible-item__header"),s=null==(t=this.shadowRoot)?void 0:t.querySelector(".collapsible-item__toggle-container");i&&s&&(n?(i.style.flexDirection="row-reverse",s.style.margin="0 0 0 8px"):(i.style.flexDirection="row",s.style.margin="0 8px 0 0"))}attributeChangedCallback(e,t,n){"expanded"===e&&t!==n?(this.expanded=null!==n,this._updateAriaExpanded()):"reverse-heading"===e&&this._updateReverseHeading()}}customElements.get("collapsible-item")||customElements.define("collapsible-item",s);const o=Object.freeze(Object.defineProperty({__proto__:null,CollapsibleItem:s},Symbol.toStringTag,{value:"Module"}));let l={};async function a(){try{const e=await Promise.resolve().then(()=>p);l.SelectionMenu=e.default||e}catch(e){}try{const e=await Promise.resolve().then(()=>b);l.ProductLayout=e.default||e}catch(e){}return l}function r(){return l}const d=Object.freeze(Object.defineProperty({__proto__:null,CollapsibleItem:s,CollapsibleList:n,getAdditionalComponents:r,loadAdditionalComponents:a},Symbol.toStringTag,{value:"Module"})),h={};Object.entries(d).forEach(([e,n])=>{if("function"==typeof n&&n.name){const i=t.forwardRef(({children:i,...s},o)=>{const l=t.useRef(null),a=t.useRef({});t.useEffect(()=>{const e=l.current,t={};return Object.entries(s).forEach(([n,i])=>{if("function"==typeof i&&n.startsWith("on")){const s=n.substring(2).toLowerCase(),o=e=>{i(e)};e.addEventListener(s,o),t[s]=o}}),a.current=t,()=>{Object.entries(a.current).forEach(([t,n])=>{e.removeEventListener(t,n)})}},[s]);const r=Object.entries(s).reduce((e,[t,n])=>("function"==typeof n&&t.startsWith("on")||(e[t]=n),e),{});t.useEffect(()=>{o&&("function"==typeof o?o(l.current):o.current=l.current)},[o]);const d=n.is||e.toLowerCase();return React.createElement(d,{ref:l,...r},i)});i.displayName=e,h[e]=i}});const c={install(e){Object.entries(d).forEach(([t,n])=>{if("function"==typeof n&&n.name){const i=n.is||t.toLowerCase(),s={name:t,inheritAttrs:!1,emits:[],props:{},render(){const e=Object.entries(this.$attrs).reduce((e,[t,n])=>(e[t.replace(/-([a-z])/g,e=>e[1].toUpperCase())]=n,e),{}),t={};return Object.keys(this.$listeners).forEach(e=>{t[e]=this.$listeners[e]}),this.$createElement(i,{attrs:e,on:t,ref:"webComponent"},this.$slots.default)}};e.component(t,s)}})}},m={...r(),async load(){return await a(),Object.assign(this,r()),this}};"undefined"!=typeof window&&m.load().catch(console.error);class g extends HTMLElement{static get observedAttributes(){return["value","data","block-events-on-parent","reverse-heading"]}constructor(){super(),this.attachShadow({mode:"open"}),this._selectedId=null,this._data=[],this._blockEventsOnParent=!1,this._reverseHeading=!0}connectedCallback(){this.render(),this.setupEventListeners()}attributeChangedCallback(e,t,n){if(t!==n)switch(e){case"data":this.data=n?JSON.parse(n):[];break;case"value":this.setSelectedItem(n);break;case"block-events-on-parent":this.blockEventsOnParent=null!==n;break;case"reverse-heading":this.reverseHeading="false"!==n}}render(){this.shadowRoot.innerHTML="";const e=document.createElement("style");e.textContent="\n      :host {\n        display: block;\n        --primary-color: #4a6cf7;\n        --primary-light: #e6f0ff;\n        --hover-color: #f5f8ff;\n        --selected-color: #e6f0ff;\n        --text-color: #2d3748;\n        --text-secondary: #4a5568;\n        --border-color: #e2e8f0;\n        --border-radius: 4px;\n        --transition: all 0.2s ease;\n      }\n      \n      .selection-menu {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n      }\n      \n      .selection-menu__header {\n        padding: 12px 16px;\n        border-bottom: 1px solid var(--border-color);\n        font-weight: 600;\n        color: var(--text-color);\n      }\n      \n      .selection-menu__container {\n        flex: 1;\n        padding: 8px 0;\n        overflow-y: auto;\n      }\n      \n      .selection-menu__item {\n        display: flex;\n        align-items: center;\n        box-sizing: border-box;\n        padding: 8px 0;\n        cursor: pointer;\n      }\n      \n      \n      .selection-menu__item--selected {\n        background-color: var(--selected-color);\n        color: var(--primary-color);\n        font-weight: 500;\n      }\n      \n      .selection-menu__item--level-1 {\n        padding-left: 32px;\n      }\n      \n      .selection-menu__item--level-2 {\n        padding-left: 48px;\n      }\n      \n      .selection-menu__item--level-3 {\n        padding-left: 64px;\n      }\n    ";const t=document.createElement("div");t.className="selection-menu",t.innerHTML=`\n      <div class="selection-menu__wrapper">\n        <div class="selection-menu__container">\n          <collapsible-list id="menuList" class="selection-menu__list" aria-label="Menu" reverse-heading="${this._reverseHeading}">\n            ${this.renderItems(this._data)}\n          </collapsible-list>\n        </div>\n      </div>\n    `,this.shadowRoot.appendChild(e),this.shadowRoot.appendChild(t),this.setupEventListeners()}renderItems(e,t=0){return e.map(e=>{const n=e.children&&e.children.length>0,i=this._selectedId===e.id;return`\n        <collapsible-item \n          class="selection-menu__item selection-menu__item--level-${t}"\n          value="${e.id}" \n          data-id="${e.id}" \n          level="${t}" \n          ${n?"":"no-children hide-icon"} \n          reverse-heading="${this._reverseHeading}"\n          ${i?"selected":""}\n        >\n          <span slot="header" class="selection-menu__item-header ${i?"selection-menu__item-header--selected":""}">\n            ${e.name}\n          </span>\n          ${n?`\n            <collapsible-list class="selection-menu__list">\n              ${this.renderItems(e.children,t+1)}\n            </collapsible-list>\n          `:""}\n        </collapsible-item>\n      `}).join("")}setupEventListeners(){const e=this.shadowRoot.getElementById("menuList");e&&(this._boundHandleClick=this.handleItemClick.bind(this),e.addEventListener("click",this._boundHandleClick,!0))}handleItemClick(e){const t=e.target.closest("collapsible-item");if(!t)return;const n=t.getAttribute("data-id");if(!n)return;const i=this._findItemById(this._data,n);if(i&&i.children&&i.children.length>0)return;this.setSelectedItem(n);const s=new CustomEvent("item-selected",{detail:{id:n,item:i},bubbles:!0,composed:!0});this.dispatchEvent(s),window.dispatchEvent(new CustomEvent("global-item-selected",{detail:{id:n,item:i}}))}_findItemById(e,t){for(const n of e){if(n.id===t)return n;if(n.children){const e=this._findItemById(n.children,t);if(e)return e}}return null}setSelectedItem(e){if(e===this._selectedId)return!1;if(this._selectedId){const e=this.shadowRoot.querySelector(`collapsible-item[data-id="${this._selectedId}"]`);e&&e.removeAttribute("selected")}this._selectedId=e;const t=this.shadowRoot.querySelector(`collapsible-item[data-id="${e}"]`);return t&&t.setAttribute("selected",""),e?this.setAttribute("value",e):this.removeAttribute("value"),!0}get data(){return this._data}set data(e){if(Array.isArray(e))this._data=e,this.render();else if("string"==typeof e)try{this._data=JSON.parse(e),this.render()}catch(t){}}get blockEventsOnParent(){return this._blockEventsOnParent}set blockEventsOnParent(e){return void 0!==e&&(this._blockEventsOnParent=e,this.setAttribute("block-events-on-parent",e?"":null)),this._blockEventsOnParent}get reverseHeading(){return this._reverseHeading}set reverseHeading(e){const t=!1!==e&&"false"!==e&&null!==e;this._reverseHeading!==t&&(this._reverseHeading=t,this.setAttribute("reverse-heading",t?"":null),this.render());const n=document.createElement("style");n.textContent="\n      :host {\n        display: block;\n        width: 100%;\n      }\n      \n      #menuList {\n        list-style: none;\n        margin: 0;\n        padding: 0;\n      }\n    ";const i=document.createElement("div");i.id="menuList",this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(n),this.shadowRoot.appendChild(i),i.innerHTML=this.renderItems(this._data),this.setupEventListeners()}}customElements.get("selection-menu")||customElements.define("selection-menu",g);const p=Object.freeze(Object.defineProperty({__proto__:null,SelectionMenu:g},Symbol.toStringTag,{value:"Module"}));class _ extends HTMLElement{static get observedAttributes(){return["images","no-animation"]}constructor(){super(),this.attachShadow({mode:"open"}),this._images=[],this._hasRendered=!1,this._handleItemClick=this._handleItemClick.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this),this._handleToggle=this._handleToggle.bind(this),this._currentOpenItem=null,this._initialized=!1,this._lastOpenedIndex=-1,this._mutationObserver=null,this._intersectionObserver=null,this._preloadedImages=new Map,this._visibleIndices=new Set,this._preloadDistance=2,this._isInitialLoad=!0}get images(){return this._images}set images(e){if(Array.isArray(e))this._images=e,this._preloadImages(),this._render();else if("string"==typeof e)try{this._images=JSON.parse(e),this._preloadImages(),this._render()}catch(t){}}connectedCallback(){if(!this._initialized){this._initialized=!0,this._render();this._isInitialLoad=!0;if(this.shadowRoot.querySelectorAll(".image-container").forEach(e=>{e.style.height="300px"}),this.hasAttribute("no-animation")){this.shadowRoot.querySelectorAll(".image-collection__image").forEach(e=>e.classList.add("loaded"))}else this.classList.add("initial-load");this._addEventListeners(),this._setupMutationObserver(),this.preloadAllImages(),this._hasExpandedItem()||this._setFirstItemExpanded()}}_addEventListeners(){this.addEventListener("toggle",e=>{const t=e.target;if(t.parentElement===this.shadowRoot.querySelector("collapsible-list")&&e.detail.expanded){this._closeOtherItems(t);const e=Array.from(this.shadowRoot.querySelectorAll("collapsible-item"));this.dispatchEvent(new CustomEvent("item-selected",{detail:{index:e.indexOf(t),item:t},bubbles:!0,composed:!0}))}}),this.addEventListener("keydown",e=>{const t=Array.from(this.shadowRoot.querySelectorAll("collapsible-item")),n=t.findIndex(e=>e===document.activeElement.closest("collapsible-item"));if(-1!==n)switch(e.key){case"ArrowDown":e.preventDefault();t[(n+1)%t.length].focus();break;case"ArrowUp":e.preventDefault();t[(n-1+t.length)%t.length].focus();break;case"Home":e.preventDefault(),t[0].focus();break;case"End":e.preventDefault(),t[t.length-1].focus();break;case"Enter":case" ":e.preventDefault(),t[n].expanded||t[n].click()}})}_closeOtherItems(e){if(!this.shadowRoot)return;const t=Array.from(this.shadowRoot.querySelectorAll("collapsible-item")),n=t.indexOf(e);this._lastOpenedIndex=n,this._currentOpenItem=e,t.forEach(t=>{t!==e&&(t.expanded=!1)}),e&&(e.expanded=!0,this.dispatchEvent(new CustomEvent("item-selected",{detail:{index:n,item:e},bubbles:!0,composed:!0})))}_hasExpandedItem(){if(!this.shadowRoot)return!1;const e=this.shadowRoot.querySelectorAll("collapsible-item");return Array.from(e).some(e=>e&&e.expanded)}_setFirstItemExpanded(){requestAnimationFrame(()=>{var e;const t=null==(e=this.shadowRoot)?void 0:e.querySelectorAll("collapsible-item");t&&t.length>0&&-1===this._lastOpenedIndex&&(t[0].expanded=!0,this._currentOpenItem=t[0],this._lastOpenedIndex=0)})}_handleItemClick(e){e.stopImmediatePropagation();const t=e.target.closest("collapsible-item");if(!t)return!1;if(e.preventDefault(),t===this._currentOpenItem)return!1;this._closeOtherItems(t),t.expanded=!0;const n=Array.from(this.shadowRoot.querySelectorAll("collapsible-item"));return this._currentOpenItem=t,this._lastOpenedIndex=n.indexOf(t),this.dispatchEvent(new CustomEvent("item-selected",{detail:{index:this._lastOpenedIndex,item:t},bubbles:!0,composed:!0})),!1}_setupIntersectionObserver(){this._intersectionObserver&&(this._intersectionObserver.disconnect(),this._intersectionObserver=null)}_observeItems(){}disconnectedCallback(){Array.from(this.shadowRoot.querySelectorAll("collapsible-item")).forEach(e=>{e.removeEventListener("click",this._handleItemClick),e.removeEventListener("toggle",this._handleToggle)}),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._intersectionObserver&&(this._intersectionObserver.disconnect(),this._intersectionObserver=null)}attributeChangedCallback(e,t,n){"images"===e&&t!==n&&(this.images=n)}_setupEventListeners(){Array.from(this.shadowRoot.querySelectorAll("collapsible-item")).forEach((e,t)=>{e.removeEventListener("click",this._handleItemClick),e.removeEventListener("keydown",this._handleKeyDown),e.removeEventListener("toggle",this._handleToggle),e._originalClickHandler||(e._originalClickHandler=e._onClick),e._onClick=t=>{var n;return e===this._currentOpenItem?(t.preventDefault(),t.stopImmediatePropagation(),!1):null==(n=e._originalClickHandler)?void 0:n.call(e,t)},e.addEventListener("click",this._handleItemClick,{capture:!0}),e.addEventListener("keydown",this._handleKeyDown,{capture:!0}),e.addEventListener("toggle",this._handleToggle,{capture:!0}),e.setAttribute("tabindex","0"),e.setAttribute("role","button")}),this._hasRendered=!0}_setupMutationObserver(){this._mutationObserver=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&this._setupEventListeners()})}),this._mutationObserver.observe(this.shadowRoot,{childList:!0,subtree:!0})}_handleToggle(e){return e.stopPropagation(),e.preventDefault(),!1}_handleKeyDown(e){if("Enter"===e.key||" "===e.key)e.preventDefault(),this._handleItemClick(e);else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();const t=Array.from(this.shadowRoot.querySelectorAll("collapsible-item")),n=t.indexOf(e.target);let i;i="ArrowDown"===e.key?(n+1)%t.length:(n-1+t.length)%t.length;const s=t[i];s&&(s.focus(),s.click())}}getOpenItemIndex(){return this._lastOpenedIndex}_closeOtherItems(e){if(!this.shadowRoot)return;const t=Array.from(this.shadowRoot.querySelectorAll("collapsible-item")),n=t.indexOf(e);e!==this._currentOpenItem?(t.forEach((e,t)=>{t!==n?e.expanded=!1:(e.expanded=!0,this._currentOpenItem=e,this._lastOpenedIndex=n)}),this.dispatchEvent(new CustomEvent("item-selected",{detail:{index:n,item:e},bubbles:!0,composed:!0}))):e.expanded||(e.expanded=!0)}preloadAllImages(){this._images&&Array.isArray(this._images)&&this._images.forEach((e,t)=>{e&&e.src&&setTimeout(()=>{this._preloadedImages.has(e.src)&&"error"!==this._preloadedImages.get(e.src).status||this._loadImage(e,t,!1)},50*t)})}getImageStatus(e){if(!this._images||!this._images[e]||!this._images[e].src)return;const t=this._preloadedImages.get(this._images[e].src);return t?t.status:void 0}openItem(e){if(!this.shadowRoot)return;const t=Array.from(this.shadowRoot.querySelectorAll("collapsible-item"));if(e>=0&&e<t.length){if(t[e]===this._currentOpenItem)return;t.forEach(e=>{e.expanded=!1}),t[e].expanded=!0,this._currentOpenItem=t[e],this._lastOpenedIndex=e,this.dispatchEvent(new CustomEvent("item-selected",{detail:{index:e,item:t[e]},bubbles:!0,composed:!0}))}}_preloadImages(e=null){this._images&&Array.isArray(this._images)&&(null!==e&&this._images[e]&&this._loadImage(this._images[e],e,!0),this._images.forEach((t,n)=>{if(null!==e&&n===e)return;const i=t.src;this._preloadedImages.has(i)&&"error"!==this._preloadedImages.get(i).status||this._loadImage(t,n,!1)}))}_loadImage(e,t,n=!1){if(!e||!e.src)return;let i=e.src;if(i.startsWith("http")||i.startsWith("data:")||i.startsWith("/")||(i=`/${i}`),this._preloadedImages.has(i)){const e=this._preloadedImages.get(i).status;if(("loaded"===e||"loading"===e)&&!n)return}this._preloadedImages.set(i,{status:"loading"});const s="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";this._updateImageInDOM(i,s,!1);const o=new Image;o.onload=()=>{this._preloadedImages.set(i,{status:"loaded",element:o,width:o.width,height:o.height}),this._updateImageInDOM(i,i)},o.onerror=e=>{this._preloadedImages.set(i,{status:"error",error:e}),this._updateImageInDOM(i,s,!0)},o.src=i}_updateImageInDOM(e,t,n=!1){if(!this.shadowRoot)return;let i=[];const s=Array.from(this.shadowRoot.querySelectorAll("img[data-src]"));if(i=s.filter(t=>{const n=t.getAttribute("data-src");return n&&(n===e||n.endsWith(`/${e}`)||n.endsWith(e))}),0===i.length){const t=e.split("/").pop();i=s.filter(e=>{const n=e.getAttribute("data-src");return n&&n.endsWith(t)})}if(0===i.length){const t=e.split("/").pop();i=s.filter(e=>{const n=e.getAttribute("data-src");return n&&n.includes(t)})}if(0===i.length){const t=Array.from(this.shadowRoot.querySelectorAll("img")),n=this._images.findIndex(t=>t&&t.src===e);n>=0&&n<t.length&&(i=[t[n]])}0===i.length&&(i=Array.from(this.shadowRoot.querySelectorAll(`img[src="${e}"]`)));const o=this._preloadedImages.get(e),l=this._isInitialLoad&&(!o||!1!==o.isInitialLoad);i.forEach(e=>{if(n)e.classList.add("image-error"),e.alt="Failed to load image",e.classList.remove("loading");else if(t)if(e.src=t,e.removeAttribute("data-src"),l)e.classList.add("loaded"),o&&(o.isInitialLoad=!1);else{const t=e.closest(".image-container");if(t){const n=t.offsetHeight;t.style.height=`${n}px`,t.style.transition="height 0.3s ease-in-out",t.offsetHeight,t.style.height="auto";const i=t.offsetHeight;t.style.height=`${n}px`,requestAnimationFrame(()=>{e.classList.add("loaded"),t.style.height=`${i}px`}),t.addEventListener("transitionend",function e(){t.style.height="",t.style.transition="",t.removeEventListener("transitionend",e)})}else e.classList.add("loaded")}const i=e.nextElementSibling;i&&i.classList.contains("image-loader")&&i.remove()})}_render(){if(!this.shadowRoot)return;const e=this._lastOpenedIndex,t=!this._hasRendered,n=this.hasAttribute("no-animation"),s=`\n      \n      <style>\n        .image-collection {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n          max-width: 100%;\n          margin: 0 auto;\n        }\n        \n        .image-container {\n          position: relative;\n          width: 100%;\n          height: 300px;\n          min-height: 300px;\n          overflow: hidden;\n          contain: content;\n          will-change: height;\n        }\n        \n        .image-collection__image {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n          transition: opacity 0.3s ease-in-out, height 0.3s ease-in-out;\n          opacity: 0;\n        }\n        \n        :host([no-animation]) .image-collection__image {\n          opacity: 1;\n          transition: none;\n        }\n        \n        /* Initial load - use opacity transition */\n        .initial-load .image-container {\n          height: 300px !important;\n          transition: none !important;\n        }\n        \n        .initial-load .image-collection__image {\n          height: 100%;\n          opacity: 0;\n          transition: opacity 0.3s ease-in-out;\n        }\n        \n        .initial-load .image-collection__image.loaded {\n          opacity: 1;\n        }\n        \n        /* Subsequent loads - use height transition */\n        .image-collection__image.loaded {\n          opacity: 1;\n          height: 100%;\n        }\n        \n        .image-collection__image.image-error {\n          opacity: 1;\n          background-color: #f5f5f5;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: #999;\n          font-style: italic;\n        }\n        \n        .image-loader {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: #999;\n          font-style: italic;\n        }\n        \n        .image-collection__image.loaded + .image-loader {\n          display: none;\n        }\n        \n        .image-collection__title {\n          margin: 0;\n          padding: 0.8rem 1rem;\n          color: #333;\n          font-size: 0.8em;\n          font-weight: 600;\n          background: rgba(0,0,0,0.4);\n          color: white;\n          transition: all 0.2s ease;\n          position: relative;\n          z-index: 1;\n          line-height: 1.2;\n          border: none;\n          display: block;\n          width: 100%;\n          text-align: left;\n          color: white;\n          position: absolute;\n          top: 0;\n        }\n\n        \n        collapsible-item {\n          cursor: pointer;\n          transition: background-color 0.2s;\n          border: none;\n          margin: 0;\n          padding: 0;\n          overflow: hidden;\n          display: block;\n          min-height: 45px;\n          position: relative;\n        }\n        \n        collapsible-item:not(:last-child) .image-collection__title {\n          border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n        }\n        \n        @keyframes fadeIn {\n          from { opacity: 0.3; }\n          to { opacity: 1; }\n        }\n      </style>\n    \n      <div class="image-collection">\n        <collapsible-list>\n          ${this._images.map((e,t)=>{let n=e.src;!n||n.startsWith("http")||n.startsWith("data:")||(n=n.startsWith("/")?n:`/${n}`);const i=this._preloadedImages.has(n)&&"loaded"===this._preloadedImages.get(n).status,s=this._preloadedImages.has(n)&&"loading"===this._preloadedImages.get(n).status,o=["image-collection__image"];return i?o.push("loaded"):s&&o.push("loading"),`\n        <collapsible-item hide-icon data-index="${t}">\n          <div class="image-container">\n            <img\n              ${i?`src="${n}"`:`src="" data-src="${n}"`}\n              alt="${e.alt||e.title||"Image"}"\n              class="${o.join(" ")}"\n              loading="lazy"\n              onerror="this.onerror=null;this.classList.add('image-error');"\n            />\n            ${i?"":'<div class="image-loader">Loading...</div>'}\n          </div>\n          <div slot="header" class="image-collection__title">${e.title||`Image ${t+1}`}</div>\n          ${e.description?`<div slot="content">${e.description}</div>`:""}\n        </collapsible-item>\n      `}).join("")}\n        </collapsible-list>\n      </div>\n    `;if(this.shadowRoot.innerHTML=s,t){this.shadowRoot.querySelectorAll(".image-container").forEach(e=>{e.style.height="300px"})}return this._intersectionObserver||this._setupIntersectionObserver(),this._setupEventListeners(),e>=0?this.openItem(e):this._images.length>0&&this.openItem(0),this._preloadImages(),this._hasRendered=!0,Promise.all([customElements.get("collapsible-list")||Promise.resolve().then(()=>i),customElements.get("collapsible-item")||Promise.resolve().then(()=>o)]).then(()=>{this._setupEventListeners();const i=Array.from(this.shadowRoot.querySelectorAll("collapsible-item"));if(i.length>0)if(-1!==e&&e<i.length)i[e].expanded=!0,this._currentOpenItem=i[e],this._lastOpenedIndex=e;else if(t&&this._images.length>0&&-1===e&&(this._lastOpenedIndex=0,n)){const e=this.shadowRoot.querySelectorAll("collapsible-item");e.length>0&&(e[0].expanded=!0,this._currentOpenItem=e[0])}this._hasRendered=!0})}}customElements.get("image-collection")||customElements.define("image-collection",_);class u extends HTMLElement{static get observedAttributes(){return["title","images"]}constructor(){super(),this.attachShadow({mode:"open"}),this._title="",this._images=[],this._isConnected=!1,this._hasRendered=!1,this._isUpdating=!1,this._elements=null,this._render=this._render.bind(this)}get title(){return this._title}set title(e){const t=e||"";this._title!==t&&(this._title=t,this._isConnected&&this._updateTitle())}get images(){return this._images}set images(e){let t=[];if("string"==typeof e)try{t=e?JSON.parse(e):[]}catch(i){t=[]}else Array.isArray(e)&&(t=[...e]);const n=JSON.stringify(this._images)!==JSON.stringify(t);this._images=t,n&&this._isConnected&&this._updateImages()}connectedCallback(){if(!this._isConnected){if(this._isConnected=!0,this.hasAttribute("title")&&(this._title=this.getAttribute("title")),this.hasAttribute("images"))try{this._images=JSON.parse(this.getAttribute("images")||"[]")}catch(e){this._images=[]}this._render()}}attributeChangedCallback(e,t,n){if(t!==n)switch(e){case"title":this.title=n;break;case"images":this.images=n}}_renderImageCollection(){if(!this._images||0===this._images.length)return"";const e=Array.isArray(this._images)?this._images:[];return`\n      <div>\n        <image-collection \n          images='${JSON.stringify(e)}'\n          style="--image-height: 400px;"\n          no-animation\n        ></image-collection>\n      </div>\n    `}_cacheElements(){this.shadowRoot&&(this._elements={title:this.shadowRoot.querySelector(".header h2"),imageContainer:this.shadowRoot.querySelector(".image-collection-container"),header:this.shadowRoot.querySelector(".header"),content:this.shadowRoot.querySelector(".content")})}_updateTitle(){var e;this.shadowRoot&&((null==(e=this._elements)?void 0:e.title)?this._elements.title.textContent=this._title:this._isConnected&&this._render())}_updateImages(){var e;if(!this._isUpdating&&this.shadowRoot&&this._isConnected){this._isUpdating=!0;try{const t=this.shadowRoot.querySelector("image-collection");if(t){const e=t.getAttribute("images"),n=JSON.stringify(this._images);e!==n&&t.setAttribute("images",n)}else(null==(e=this._elements)?void 0:e.imageContainer)?this._elements.imageContainer.innerHTML=this._renderImageCollection():this._hasRendered||this._render()}finally{this._isUpdating=!1}}}_render(){if(!this._isUpdating&&this.shadowRoot&&this._isConnected){this._isUpdating=!0;try{this._hasRendered?this._isUpdating||(this._updateTitle(),this._updateImages()):(this.shadowRoot.innerHTML=`\n      <style>\n        :host {\n          display: block;\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          --primary-color: #00f0ff;\n          --text-color: #e0e0e0;\n          --text-secondary: #8f9bb3;\n          --border-color: #2a2a3a;\n          --bg-color: #1a1a2e;\n        }\n        \n        \n        .image-collection-container {\n          width: 100%;\n          position: relative;\n          border-radius: 8px;\n          background-color: #1a1a1a;\n          margin-bottom: 0;\n          overflow: hidden;\n        }\n        \n        .header {\n          padding: 1rem 0;\n        }\n        \n        .header h2 {\n          margin: 0;\n          color: var(--text-color);\n          font-size: 1.5rem;\n          font-weight: 600;\n        }\n        \n        .divider {\n          border: none;\n          height: 1px;\n          background-color: white;\n          margin: 0;\n        }\n        \n        .content {\n          padding: 0;\n          color: var(--text-secondary);\n          line-height: 1.6;\n        }\n        \n        ::slotted(.vehicle-description) {\n          color: var(--text-secondary);\n          line-height: 1.7;\n        }\n        \n        ::slotted(.vehicle-specs) {\n          margin-top: 1.5rem;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 8px;\n          padding: 1.5rem;\n          border: 1px solid var(--border-color);\n        }\n        \n        ::slotted(.vehicle-specs h3) {\n          color: var(--primary-color);\n          margin-top: 0;\n          margin-bottom: 1.25rem;\n          font-size: 1.25rem;\n          font-weight: 600;\n          border-bottom: 1px solid var(--border-color);\n          padding-bottom: 0.75rem;\n        }\n        \n        ::slotted(.vehicle-specs ul) {\n          list-style: none;\n          padding: 0;\n          margin: 0;\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n          gap: 0.75rem;\n        }\n        \n        ::slotted(.vehicle-specs li) {\n          padding: 0.75rem 1rem;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 6px;\n          border-left: 3px solid var(--primary-color);\n          transition: var(--transition, all 0.3s ease);\n        }\n        \n        ::slotted(.vehicle-specs li:hover) {\n          background: rgba(0, 240, 255, 0.1);\n          transform: translateX(4px);\n        }\n        \n        ::slotted(.vehicle-specs strong) {\n          color: var(--primary-color);\n          margin-right: 0.5rem;\n          font-weight: 500;\n        }\n      </style>\n      <div class="product-layout">\n        ${this._images.length>0?`\n          <div class="image-collection-container">\n            ${this._renderImageCollection()}\n          </div>\n        `:""}\n        \n        <div class="header">\n          <div class="divider"></div>\n          <h2>${this._title}</h2>\n        </div>\n        \n        <div class="content">\n          <slot name="content"></slot>\n        </div>\n      </div>`,this._hasRendered=!0,this._cacheElements())}finally{this._isUpdating=!1}}}}"undefined"==typeof window||customElements.get("product-layout")||customElements.define("product-layout",u);const b=Object.freeze(Object.defineProperty({__proto__:null,ProductLayout:u},Symbol.toStringTag,{value:"Module"}));e.CollapsibleItem=s,e.CollapsibleList=n,e.Components=m,e.ReactWrappers=h,e.VuePlugin=c,e.getAdditionalComponents=r,e.loadAdditionalComponents=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
