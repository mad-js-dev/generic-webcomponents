{"version":3,"file":"SelectionMenu-CfWl8hxy.js","sources":["../src/components/organisms/selection-menu/SelectionMenu.js"],"sourcesContent":["/**\n * SelectionMenu Component\n * A custom element that creates a selectable menu using collapsible-list components\n */\n\nexport class SelectionMenu extends HTMLElement {\n  static get observedAttributes() {\n    return ['value', 'data', 'block-events-on-parent', 'reverse-heading'];\n  }\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this._selectedId = null;\n    this._data = [];\n    this._blockEventsOnParent = false;\n    this._reverseHeading = true;\n  }\n\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue === newValue) return;\n\n    switch (name) {\n      case 'data':\n        this.data = newValue ? JSON.parse(newValue) : [];\n        break;\n      case 'value':\n        this.setSelectedItem(newValue);\n        break;\n      case 'block-events-on-parent':\n        this.blockEventsOnParent = newValue !== null;\n        break;\n      case 'reverse-heading':\n        this.reverseHeading = newValue !== 'false';\n        break;\n    }\n  }\n\n  render() {\n    // Clear the shadow root\n    this.shadowRoot.innerHTML = '';\n    \n    // Create and append style element\n    const style = document.createElement('style');\n    style.textContent = `\n      :host {\n        display: block;\n        --primary-color: #4a6cf7;\n        --primary-light: #e6f0ff;\n        --hover-color: #f5f8ff;\n        --selected-color: #e6f0ff;\n        --text-color: #2d3748;\n        --text-secondary: #4a5568;\n        --border-color: #e2e8f0;\n        --border-radius: 4px;\n        --transition: all 0.2s ease;\n      }\n      \n      .selection-menu {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n      }\n      \n      .selection-menu__header {\n        padding: 12px 16px;\n        border-bottom: 1px solid var(--border-color);\n        font-weight: 600;\n        color: var(--text-color);\n      }\n      \n      .selection-menu__container {\n        flex: 1;\n        padding: 8px 0;\n        overflow-y: auto;\n      }\n      \n      .selection-menu__item {\n        display: flex;\n        align-items: center;\n        box-sizing: border-box;\n        padding: 8px 0;\n        cursor: pointer;\n      }\n      \n      \n      .selection-menu__item--selected {\n        background-color: var(--selected-color);\n        color: var(--primary-color);\n        font-weight: 500;\n      }\n      \n      .selection-menu__item--level-1 {\n        padding-left: 32px;\n      }\n      \n      .selection-menu__item--level-2 {\n        padding-left: 48px;\n      }\n      \n      .selection-menu__item--level-3 {\n        padding-left: 64px;\n      }\n    `;\n    \n    // Create the main container\n    const container = document.createElement('div');\n    container.className = 'selection-menu';\n    container.innerHTML = `\n      <div class=\"selection-menu__wrapper\">\n        <div class=\"selection-menu__container\">\n          <collapsible-list id=\"menuList\" class=\"selection-menu__list\" aria-label=\"Menu\" reverse-heading=\"${this._reverseHeading}\">\n            ${this.renderItems(this._data)}\n          </collapsible-list>\n        </div>\n      </div>\n    `;\n    \n    // Append style and container to shadow root\n    this.shadowRoot.appendChild(style);\n    this.shadowRoot.appendChild(container);\n    \n    // Set up event listeners after the DOM is ready\n    this.setupEventListeners();\n  }\n  \n  renderItems(items, level = 0) {\n    return items.map(item => {\n      const hasChildren = item.children && item.children.length > 0;\n      const isSelected = this._selectedId === item.id;\n      \n      return `\n        <collapsible-item \n          class=\"selection-menu__item selection-menu__item--level-${level}\"\n          value=\"${item.id}\" \n          data-id=\"${item.id}\" \n          level=\"${level}\" \n          ${!hasChildren ? 'no-children hide-icon' : ''} \n          reverse-heading=\"${this._reverseHeading}\"\n          ${isSelected ? 'selected' : ''}\n        >\n          <span slot=\"header\" class=\"selection-menu__item-header ${isSelected ? 'selection-menu__item-header--selected' : ''}\">\n            ${item.name}\n          </span>\n          ${hasChildren ? `\n            <collapsible-list class=\"selection-menu__list\">\n              ${this.renderItems(item.children, level + 1)}\n            </collapsible-list>\n          ` : ''}\n        </collapsible-item>\n      `;\n    }).join('');\n  }\n  \n  setupEventListeners() {\n    const menuList = this.shadowRoot.getElementById('menuList');\n    \n    if (!menuList) {\n      console.error('menuList element not found in shadow DOM');\n      return;\n    }\n    \n    // Store the bound function so we can remove it later\n    this._boundHandleClick = this.handleItemClick.bind(this);\n    \n    // Add click listener with capture phase to catch all clicks\n    menuList.addEventListener('click', this._boundHandleClick, true);\n  }\n  \n  handleItemClick(event) {\n    // Check if the click is on a collapsible-item or its children\n    const item = event.target.closest('collapsible-item');\n    \n    if (!item) {\n      return;\n    }\n    \n    const itemId = item.getAttribute('data-id');\n    \n    if (!itemId) {\n      return;\n    }\n    \n    // Find the item data to check if it's a leaf node\n    const itemData = this._findItemById(this._data, itemId);\n    \n    // Only proceed if this is a leaf node (no children)\n    if (itemData && itemData.children && itemData.children.length > 0) {\n      return;\n    }\n    \n    this.setSelectedItem(itemId);\n    \n    // Create and dispatch the custom event for leaf items only\n    const customEvent = new CustomEvent('item-selected', {\n      detail: { \n        id: itemId,\n        item: itemData\n      },\n      bubbles: true,\n      composed: true\n    });\n    \n    this.dispatchEvent(customEvent);\n    \n    // Dispatch to window as a fallback\n    window.dispatchEvent(new CustomEvent('global-item-selected', {\n      detail: { \n        id: itemId,\n        item: itemData\n      }\n    }));\n  }\n  \n  // Helper method to find an item by ID in nested data\n  _findItemById(items, id) {\n    for (const item of items) {\n      if (item.id === id) return item;\n      if (item.children) {\n        const found = this._findItemById(item.children, id);\n        if (found) return found;\n      }\n    }\n    return null;\n  }\n  \n  // Public method to set the selected item by ID\n  setSelectedItem(id) {\n    if (id === this._selectedId) return false;\n    \n    // Remove selected class from previously selected item\n    if (this._selectedId) {\n      const prevSelected = this.shadowRoot.querySelector(`collapsible-item[data-id=\"${this._selectedId}\"]`);\n      if (prevSelected) {\n        prevSelected.removeAttribute('selected');\n      }\n    }\n    \n    // Set new selected item\n    this._selectedId = id;\n    \n    // Add selected class to new item\n    const newSelected = this.shadowRoot.querySelector(`collapsible-item[data-id=\"${id}\"]`);\n    if (newSelected) {\n      newSelected.setAttribute('selected', '');\n    }\n    \n    // Update the value attribute\n    if (id) {\n      this.setAttribute('value', id);\n    } else {\n      this.removeAttribute('value');\n    }\n    \n    return true;\n  }\n  \n  // Getter/setter for data property\n  get data() {\n    return this._data;\n  }\n  \n  set data(value) {\n    if (Array.isArray(value)) {\n      this._data = value;\n      this.render();\n    } else if (typeof value === 'string') {\n      try {\n        this._data = JSON.parse(value);\n        this.render();\n      } catch (e) {\n        console.error('Invalid data format for selection-menu', e);\n      }\n    }\n  }\n  \n  // Getter/setter for blockEventsOnParent property\n  get blockEventsOnParent() {\n    return this._blockEventsOnParent;\n  }\n  \n  set blockEventsOnParent(value) {\n    if (value !== undefined) {\n      this._blockEventsOnParent = value;\n      this.setAttribute('block-events-on-parent', value ? '' : null);\n    }\n    return this._blockEventsOnParent;\n  }\n\n  // Getter/setter for reverseHeading property\n  get reverseHeading() {\n    return this._reverseHeading;\n  }\n\n  set reverseHeading(value) {\n    const newValue = value !== false && value !== 'false' && value !== null;\n    if (this._reverseHeading !== newValue) {\n      this._reverseHeading = newValue;\n      this.setAttribute('reverse-heading', newValue ? '' : null);\n      this.render();\n    }\n    \n    // Create style element\n    const style = document.createElement('style');\n    style.textContent = `\n      :host {\n        display: block;\n        width: 100%;\n      }\n      \n      #menuList {\n        list-style: none;\n        margin: 0;\n        padding: 0;\n      }\n    `;\n    \n    // Create menu list container\n    const menuList = document.createElement('div');\n    menuList.id = 'menuList';\n    \n    // Clear shadow root and append new elements\n    this.shadowRoot.innerHTML = '';\n    this.shadowRoot.appendChild(style);\n    this.shadowRoot.appendChild(menuList);\n    \n    // Update the menu list content\n    menuList.innerHTML = this.renderItems(this._data);\n    \n    // Re-setup event listeners after render\n    this.setupEventListeners();\n  }\n}\n\n// Define the custom element\nif (!customElements.get('selection-menu')) {\n  customElements.define('selection-menu', SelectionMenu);\n}\n"],"names":[],"mappings":"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"}